# ğŸ—ï¸ Struktur Sistem Multi-Role

## ğŸ“Š Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USERS       â”‚         â”‚    EMPLOYEES     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id              â”‚         â”‚ id               â”‚
â”‚ name            â”‚         â”‚ nama_lengkap     â”‚
â”‚ email           â”‚         â”‚ email            â”‚
â”‚ password        â”‚         â”‚ nomor_telepon    â”‚
â”‚ role            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚ tanggal_lahir    â”‚
â”‚ employee_id (FK)â”‚         â”‚ alamat           â”‚
â”‚ created_at      â”‚         â”‚ tanggal_masuk    â”‚
â”‚ updated_at      â”‚         â”‚ department_id    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ position_id      â”‚
                            â”‚ status           â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   ATTENDANCES    â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â”‚ id               â”‚
                            â”‚ karyawan_id (FK) â”‚
                            â”‚ tanggal          â”‚
                            â”‚ waktu_masuk      â”‚
                            â”‚ waktu_keluar     â”‚
                            â”‚ status_absensi   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flow Diagram Login & Authorization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚   Login     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authentication  â”‚
â”‚   Middleware    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check Role     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                     â”‚                      â”‚
       â–¼                     â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  role ==    â”‚      â”‚  role ==     â”‚      â”‚   Other      â”‚
â”‚  'admin'    â”‚      â”‚  'karyawan'  â”‚      â”‚   (403)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚
       â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redirect  â”‚      â”‚   Redirect   â”‚
â”‚   to Admin  â”‚      â”‚  to Employee â”‚
â”‚  Dashboard  â”‚      â”‚  Dashboard   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Alur Absensi Karyawan

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Karyawan Login  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Employee         â”‚
â”‚ Dashboard        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚                 â”‚
         â–¼                 â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Clock  â”‚        â”‚ Clock  â”‚      â”‚  View    â”‚
    â”‚  In    â”‚        â”‚  Out   â”‚      â”‚ History  â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚
        â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validasi:     â”‚   â”‚ Validasi:     â”‚
â”‚ - Belum absen?â”‚   â”‚ - Sudah masuk?â”‚
â”‚ - Hari ini?   â”‚   â”‚ - Belum keluarâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create/Update â”‚   â”‚ Update record â”‚
â”‚ Attendance    â”‚   â”‚ waktu_keluar  â”‚
â”‚ waktu_masuk   â”‚   â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Redirect to    â”‚
        â”‚ Dashboard      â”‚
        â”‚ with success   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—‚ï¸ Struktur Route & Controller

```
web.php
â”‚
â”œâ”€â”€ Public Routes
â”‚   â”œâ”€â”€ GET  /
â”‚   â””â”€â”€ AUTH Routes (login, register, etc.)
â”‚
â”œâ”€â”€ Admin Routes (middleware: auth, role:admin)
â”‚   â”œâ”€â”€ GET    /admin/dashboard
â”‚   â”œâ”€â”€ CRUD   /admin/employees
â”‚   â”œâ”€â”€ CRUD   /admin/departments
â”‚   â”œâ”€â”€ CRUD   /admin/positions
â”‚   â”œâ”€â”€ CRUD   /admin/salaries
â”‚   â””â”€â”€ CRUD   /admin/attendances â†’ AttendanceController
â”‚
â””â”€â”€ Employee Routes (middleware: auth, role:karyawan)
    â”œâ”€â”€ GET    /employee/dashboard â†’ Employee\DashboardController
    â”œâ”€â”€ POST   /employee/attendance/clock-in â†’ Employee\AttendanceController@clockIn
    â”œâ”€â”€ POST   /employee/attendance/clock-out â†’ Employee\AttendanceController@clockOut
    â””â”€â”€ GET    /employee/attendance/history â†’ Employee\AttendanceController@history
```

---

## ğŸ“¦ Struktur MVC

```
app/
â”‚
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ User.php
â”‚   â”‚   â”œâ”€â”€ employee() â†’ belongsTo Employee
â”‚   â”‚   â”œâ”€â”€ isAdmin()
â”‚   â”‚   â””â”€â”€ isKaryawan()
â”‚   â”‚
â”‚   â””â”€â”€ Employee.php
â”‚       â”œâ”€â”€ user() â†’ hasOne User
â”‚       â”œâ”€â”€ attendances() â†’ hasMany
â”‚       â”œâ”€â”€ department() â†’ belongsTo
â”‚       â””â”€â”€ position() â†’ belongsTo
â”‚
â”œâ”€â”€ Http/
â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”œâ”€â”€ AttendanceController.php (untuk Admin)
â”‚   â”‚   â”‚   â”œâ”€â”€ index() - List semua absensi
â”‚   â”‚   â”‚   â”œâ”€â”€ create()
â”‚   â”‚   â”‚   â”œâ”€â”€ store()
â”‚   â”‚   â”‚   â”œâ”€â”€ edit()
â”‚   â”‚   â”‚   â”œâ”€â”€ update()
â”‚   â”‚   â”‚   â””â”€â”€ destroy()
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Employee/
â”‚   â”‚       â”œâ”€â”€ DashboardController.php
â”‚   â”‚       â”‚   â””â”€â”€ index() - Dashboard + stats
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ AttendanceController.php (untuk Karyawan)
â”‚   â”‚           â”œâ”€â”€ clockIn() - Absen masuk
â”‚   â”‚           â”œâ”€â”€ clockOut() - Absen keluar
â”‚   â”‚           â””â”€â”€ history() - Riwayat pribadi
â”‚   â”‚
â”‚   â””â”€â”€ Middleware/
â”‚       â””â”€â”€ RoleMiddleware.php
â”‚           â””â”€â”€ handle() - Cek role user
â”‚
â””â”€â”€ ...

resources/views/
â”‚
â”œâ”€â”€ dashboard.blade.php (Admin Dashboard)
â”‚
â”œâ”€â”€ attendances/ (Admin views)
â”‚   â”œâ”€â”€ index.blade.php
â”‚   â”œâ”€â”€ create.blade.php
â”‚   â”œâ”€â”€ edit.blade.php
â”‚   â””â”€â”€ show.blade.php
â”‚
â””â”€â”€ employee/ (Karyawan views)
    â”œâ”€â”€ dashboard.blade.php (Tombol absen)
    â””â”€â”€ attendance-history.blade.php (Riwayat)
```

---

## ğŸ” Security Layer

```
Request
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CSRF       â”‚
â”‚  Protection  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Auth       â”‚
â”‚  Middleware  â”‚ â†’ Cek apakah user login?
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Role       â”‚
â”‚  Middleware  â”‚ â†’ Cek role sesuai?
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Controller  â”‚
â”‚   Action     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Validation  â”‚ â†’ Validasi input
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Database   â”‚
â”‚    Query     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
   Response
```

---

## ğŸ“± User Interface Flow

### Admin Dashboard:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Admin Dashboard                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Karyawan] [Departemen] [Posisi]     â”‚
â”‚  [Absensi]  [Gaji]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Employee Dashboard:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Selamat Datang, [Nama]! ğŸ‘‹         â”‚
â”‚    [Tanggal Hari Ini]                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Absensi Hari Ini                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Waktu Masuk â”‚  â”‚ Waktu Keluarâ”‚     â”‚
â”‚  â”‚   08:30 âœ“   â”‚  â”‚    --:--    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚[Absen Masuk]â”‚  â”‚[Absen Keluar]â”‚    â”‚
â”‚  â”‚  (disabled) â”‚  â”‚   (active)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ringkasan Bulan Ini  [Lihat Semua >] â”‚
â”‚  Hadir: 15  Izin: 1  Sakit: 0  Alfa: 0â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Data Flow: Clock In

```
User Click [Absen Masuk]
        â”‚
        â–¼
POST /employee/attendance/clock-in
        â”‚
        â–¼
Employee\AttendanceController@clockIn
        â”‚
        â”œâ”€â”€ Get authenticated user
        â”œâ”€â”€ Get employee data
        â”‚
        â–¼
Check if already clocked in today?
        â”‚
        â”œâ”€â”€ YES â†’ Redirect with error
        â”‚
        â”œâ”€â”€ NO â†’ Continue
        â”‚    â”‚
        â”‚    â–¼
        â”‚  Create/Update Attendance
        â”‚    â”œâ”€â”€ karyawan_id
        â”‚    â”œâ”€â”€ tanggal = today
        â”‚    â”œâ”€â”€ waktu_masuk = now()
        â”‚    â””â”€â”€ status_absensi = 'Hadir'
        â”‚
        â–¼
Redirect to dashboard with success
```

---

## ğŸ—ƒï¸ Database Relations

```
User 1 â†â”€â”€â†’ 1 Employee
         (employee_id)

Employee 1 â†â”€â”€â†’ n Attendance
           (karyawan_id)

Employee n â†â”€â”€â†’ 1 Department
           (department_id)

Employee n â†â”€â”€â†’ 1 Position
           (position_id)

Employee 1 â†â”€â”€â†’ n Salary
           (karyawan_id)
```

---

Semoga visualisasi ini membantu memahami sistem! ğŸ‰
